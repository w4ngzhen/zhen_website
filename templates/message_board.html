{% extends "base_layout.html" %}
{% import "macros/base_title.html" as base_title %}

{% block extra_head %}
<link rel="stylesheet" href="{{ get_url(path='article_content.css') }}">
<link rel="stylesheet" href="{{ get_url(path='article_markdown.css') }}">
{% endblock extra_head %}

{% block content %}
<div id="article">
    <header class="article-header">
        {{ base_title::title_with_back(title=page.title)}}
    </header>
    <div class="article-content markdown-content">
        {{ page.content | safe }}
    </div>
</div>
<div>
    <div id="come_comment_box" style="border-top: 1px solid #e5e5e5;padding: 16px;"></div>
</div>
<script src="{{ get_url(path='libs/viewerjs@1.11.7/viewer.min.js') }}"></script>
<link rel="stylesheet" href="{{ get_url(path='libs/viewerjs@1.11.7/viewer.min.css') }}"/>
<script>
  if (window.Viewer) {
    document.querySelectorAll('img').forEach(img => {
      new Viewer(img, {
        inline: false,
        navbar: false,
        toolbar: {
          zoomIn: 1,
          zoomOut: 1,
          reset: 1,
          rotateLeft: 1,
          rotateRight: 1,
        },
      });
    });
  }
</script>
<script src="{{ get_url(path='libs/come_comment_box/come_comment_box.js') }}"></script>
<link rel="stylesheet" href="{{ get_url(path='libs/come_comment_box/come_comment_box.css') }}"/>
<script>
  (function run() {
    if (!window.ComeCommentBox) {
      console.error('cannot find ComeCommentBox in window');
      return;
    }
    ComeCommentBox.init('#come_comment_box', {
      siteKey: "zhen_website",
      pageKey: "zhen_website@message_board",
      serviceBaseUrl: "https://come-server.zhen.pro/client-api",
    });
  })();
</script>
{% endblock content %}